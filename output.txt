

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 4 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P12_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 4: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.873, 1.902, 0.897, 1.216
Mean of means: 1.472
Standard deviation of means: 0.497

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA     CNU-HYa GABA CTX-CGE/MGE GABA         filtered          HY GABA           Immune       IT-ET Glut 
            1249               25               12              663             6989               14              122             7545 
        LSX GABA          MB GABA       MH-LH Glut          MY GABA   NP-CT-L6b Glut      OB-IMN GABA              OEC        OPC-Oligo 
              12               18                9              206             1423               49               16              244 
          P GABA         Vascular          CB Glut     CNU-LGE GABA      DG-IMN Glut          MY Glut       OB-CR Glut          TH Glut 
              69             2015               19                4                7                2                0                1 
    CNU-HYa Glut     CNU-MGE GABA    HY Gnrh1 Glut          MB Dopa           P Glut      Pineal Glut       MB-HB Sero 
               1                6                2                2                2                5                1 
----

Number of mice: 4
Cells per mouse: 5024, 5759, 4514, 5435
Means cells per mouse: 5183
Total cells: 20732

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 
Running checks... 
Initializing Cpp (wspc) model... Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Arc" "Bcl11b" "Camk2a" "Dlx2" "Fezf2" "Grin2a" "Ncdn" "Nptxr" "Nr4a2" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 22000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 220
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 440/4400
row: 880/4400
row: 1320/4400
row: 1760/4400
row: 2200/4400
row: 2640/4400
row: 3080/4400
row: 3520/4400
row: 3960/4400
row: 4390/4400
Extrapolated 'none' rows
Took log of observed counts
Estimated change points with LROcp and found initial baseline parameters
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Constructed grouping variable ids
Computed size of rRsum boundary vector: 1620
Finished initializing wspc object


Estimating model parameters: 
---------------


Running bootstrap fits (forking): 
Batch 0/10, 0.290987 sec/bs
Batch 1/10, 0.29504 sec/bs
Batch 2/10, 0.201724 sec/bs
Batch 3/10, 0.195144 sec/bs
Batch 4/10, 0.349818 sec/bs
Batch 5/10, 0.248346 sec/bs
Batch 6/10, 0.195132 sec/bs
Batch 7/10, 0.307207 sec/bs
Batch 8/10, 0.797522 sec/bs
Batch 9/10, 0.301302 sec/bs
All complete!

Setting median bootstrap estimates as parameters... 
Checking feasibility of provided parameters
Provided parameters are feasible
