

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 3 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3 

Mean transcript counts per cell for each mouse: 1.902, 0.897, 1.216
Mean of means: 1.338
Standard deviation of means: 0.514

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen 
             924 
         CB GABA 
              17 
         CB Glut 
              19 
    CNU-HYa GABA 
               9 
    CNU-LGE GABA 
               4 
CTX-CGE/MGE GABA 
             474 
     DG-IMN Glut 
               7 
        filtered 
            5620 
         HY GABA 
              10 
          Immune 
             104 
      IT-ET Glut 
            5527 
        LSX GABA 
               9 
         MB GABA 
              16 
         MY GABA 
             153 
         MY Glut 
               2 
  NP-CT-L6b Glut 
            1086 
      OB-CR Glut 
               0 
     OB-IMN GABA 
              45 
       OPC-Oligo 
             145 
          P GABA 
              52 
         TH Glut 
               1 
        Vascular 
            1444 
    CNU-HYa Glut 
               1 
    CNU-MGE GABA 
               6 
   HY Gnrh1 Glut 
               2 
         MB Dopa 
               2 
      MH-LH Glut 
               8 
             OEC 
              13 
          P Glut 
               2 
     Pineal Glut 
               5 
      MB-HB Sero 
               1 
----

Number of mice: 3
Cells per mouse: 5759, 4514, 5435
Means cells per mouse: 5236
Total cells: 15708

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 
Running checks... 
Initializing Cpp (wspc) model... Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Arc" "Bcl11b" "Camk2a" "Dlx2" "Fezf2" "Grin2a" "Ncdn" "Nptxr" "Nr4a2" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 17600
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 176
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/4 complete
Random level 1, 2/4 complete
Random level 2, 3/4 complete
Random level 3, 4/4 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 440/4400
row: 880/4400
row: 1320/4400
row: 1760/4400
row: 2200/4400
row: 2640/4400
row: 3080/4400
row: 3520/4400
row: 3960/4400
row: 4390/4400
Extrapolated 'none' rows
Took log of observed counts
Arc
Bcl11b
Camk2a
Dlx2
Fezf2
Grin2a
Ncdn
Nptxr
Nr4a2
Rorb
Satb2
Estimated change points with LROcp and found initial baseline parameters
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Constructed grouping variable ids
Computed size of rRsum boundary vector: 1259
Finished initializing wspc object


Estimating model paarameters: 
---------------


Running bootstrap fits (forking): 
Batch 0/100, 0.237089 sec/bs
Batch 1/100, 0.192736 sec/bs
Batch 2/100, 0.236 sec/bs
Batch 3/100, 0.218052 sec/bs
Batch 4/100, 0.151169 sec/bs
Batch 5/100, 0.279066 sec/bs
Batch 6/100, 0.208379 sec/bs
Batch 7/100, 0.221248 sec/bs
Batch 8/100, 0.239391 sec/bs
Batch 9/100, 0.209381 sec/bs
Batch 10/100, 0.194506 sec/bs
Batch 11/100, 0.260618 sec/bs
Batch 12/100, 0.194253 sec/bs
Batch 13/100, 0.198364 sec/bs
Batch 14/100, 0.183885 sec/bs
Batch 15/100, 0.196592 sec/bs
Batch 16/100, 0.202463 sec/bs
Batch 17/100, 0.27766 sec/bs
Batch 18/100, 0.273958 sec/bs
Batch 19/100, 0.211938 sec/bs
Batch 20/100, 0.163488 sec/bs
Batch 21/100, 0.265455 sec/bs
Batch 22/100, 0.237958 sec/bs
Batch 23/100, 0.195093 sec/bs
Batch 24/100, 0.274959 sec/bs
Batch 25/100, 0.184917 sec/bs
Batch 26/100, 0.185539 sec/bs
Batch 27/100, 0.193873 sec/bs
Batch 28/100, 0.157612 sec/bs
Batch 29/100, 0.232375 sec/bs
Batch 30/100, 0.247287 sec/bs
Batch 31/100, 0.194065 sec/bs
Batch 32/100, 0.265492 sec/bs
Batch 33/100, 0.207139 sec/bs
Batch 34/100, 0.205389 sec/bs
Batch 35/100, 0.200629 sec/bs
Batch 36/100, 0.198797 sec/bs
Batch 37/100, 0.157514 sec/bs
Batch 38/100, 0.158647 sec/bs
Batch 39/100, 0.175668 sec/bs
Batch 40/100, 0.247925 sec/bs
Batch 41/100, 0.178256 sec/bs
Batch 42/100, 0.200352 sec/bs
Batch 43/100, 0.14988 sec/bs
Batch 44/100, 0.265146 sec/bs
Batch 45/100, 0.203536 sec/bs
Batch 46/100, 0.232826 sec/bs
Batch 47/100, 0.246241 sec/bs
Batch 48/100, 0.164812 sec/bs
Batch 49/100, 0.189803 sec/bs
Batch 50/100, 0.195139 sec/bs
Batch 51/100, 0.196392 sec/bs
Batch 52/100, 0.230041 sec/bs
Batch 53/100, 0.190507 sec/bs
Batch 54/100, 0.225166 sec/bs
Batch 55/100, 0.184867 sec/bs
Batch 56/100, 0.244246 sec/bs
Batch 57/100, 0.227378 sec/bs
Batch 58/100, 0.219606 sec/bs
Batch 59/100, 0.20354 sec/bs
Batch 60/100, 0.159493 sec/bs
Batch 61/100, 0.243987 sec/bs
Batch 62/100, 0.150395 sec/bs
Batch 63/100, 0.214417 sec/bs
Batch 64/100, 0.264023 sec/bs
Batch 65/100, 0.213837 sec/bs
Batch 66/100, 0.219208 sec/bs
Batch 67/100, 0.23196 sec/bs
Batch 68/100, 0.24373 sec/bs
Batch 69/100, 0.160876 sec/bs
Batch 70/100, 0.27313 sec/bs
Batch 71/100, 0.190317 sec/bs
Batch 72/100, 0.291325 sec/bs
Batch 73/100, 0.212221 sec/bs
Batch 74/100, 0.192529 sec/bs
Batch 75/100, 0.228251 sec/bs
Batch 76/100, 0.201165 sec/bs
Batch 77/100, 0.236634 sec/bs
Batch 78/100, 0.199943 sec/bs
Batch 79/100, 0.195959 sec/bs
Batch 80/100, 0.285832 sec/bs
Batch 81/100, 0.228662 sec/bs
Batch 82/100, 0.18656 sec/bs
Batch 83/100, 0.184319 sec/bs
Batch 84/100, 0.243789 sec/bs
Batch 85/100, 0.20098 sec/bs
Batch 86/100, 0.247427 sec/bs
Batch 87/100, 0.159966 sec/bs
Batch 88/100, 0.28815 sec/bs
Batch 89/100, 0.262324 sec/bs
Batch 90/100, 0.180406 sec/bs
Batch 91/100, 0.258013 sec/bs
Batch 92/100, 0.217443 sec/bs
Batch 93/100, 0.192421 sec/bs
Batch 94/100, 0.189882 sec/bs
Batch 95/100, 0.183813 sec/bs
Batch 96/100, 0.227668 sec/bs
Batch 97/100, 0.196684 sec/bs
Batch 98/100, 0.223898 sec/bs
Batch 99/100, 0.17239 sec/bs
All complete!

Setting median bootstrap estimates as parameters... 
Checking feasibility of provided parameters
Provided parameters are feasible


Running stats on bootstrap results: 
----------------------------------------

Grabbing bootstrap results, only resamples with converged fit... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from bootstraped parameters... 

Stat summary (head only):
------------------------------
                              parameter
1       baseline_cortex_Rt_Arc_Tns/Blk1
2   beta_Rt_cortex_Arc_right_X_Tns/Blk1
3      beta_Rt_cortex_Arc_18_X_Tns/Blk1
4 beta_Rt_cortex_Arc_right18_X_Tns/Blk1
5       baseline_cortex_Rt_Arc_Tns/Blk2
6   beta_Rt_cortex_Arc_right_X_Tns/Blk2
     estimate      CI.low
1  8.11920507  8.11657989
2 -0.04434121 -0.04555375
3 -0.05793907 -0.05895139
4 -0.04733714 -0.04837988
5  7.15863635  7.15536551
6 -0.04420185 -0.04566534
      CI.high p.value
1  8.12098636       0
2 -0.04328109      NA
3 -0.05698353      NA
4 -0.04645440      NA
5  7.16133090       0
6 -0.04278326      NA
  p.value.adj    alpha.adj
1           0 0.0001858736
2          NA           NA
3          NA           NA
4          NA           NA
5           0 0.0001865672
6          NA           NA
  significance
1          ***
2             
3             
4             
5          ***
6             
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group     mean
1 cortex_Satb2 1.028904
        sd variance
1 1.314951 1.729097
----

Can't make TPS table without running stats... 

Printing structural summary distributions: 
----------------------------------------

Warping factors, beta distributions... 
Rate effects, gamma distribution... 
Slope effects, gamma distribution... 
tpoint effects, Gaussian distribution... 
Making rate-count plots... 
Printing child summary plots: 
----------------------------------------


Making summary plots for cortex: Arc, Bcl11b, Camk2a, Dlx2, Fezf2, Grin2a, Ncdn, Nptxr, Nr4a2, Rorb, Satb2