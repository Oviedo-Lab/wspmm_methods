

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 3 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3 

Mean transcript counts per cell for each mouse: 1.902, 0.897, 1.216
Mean of means: 1.338
Standard deviation of means: 0.514

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA          CB Glut     CNU-HYa GABA     CNU-LGE GABA CTX-CGE/MGE GABA      DG-IMN Glut 
             924               17               19                9                4              474                7 
        filtered          HY GABA           Immune       IT-ET Glut         LSX GABA          MB GABA          MY GABA 
            5620               10              104             5527                9               16              153 
         MY Glut   NP-CT-L6b Glut       OB-CR Glut      OB-IMN GABA        OPC-Oligo           P GABA          TH Glut 
               2             1086                0               45              145               52                1 
        Vascular     CNU-HYa Glut     CNU-MGE GABA    HY Gnrh1 Glut          MB Dopa       MH-LH Glut              OEC 
            1444                1                6                2                2                8               13 
          P Glut      Pineal Glut       MB-HB Sero 
               2                5                1 
----

Number of mice: 3
Cells per mouse: 5759, 4514, 5435
Means cells per mouse: 5236
Total cells: 15708

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 
Running checks... 
Initializing Cpp (wspc) model... Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Arc" "Bcl11b" "Camk2a" "Dlx2" "Fezf2" "Grin2a" "Ncdn" "Nptxr" "Nr4a2" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 17600
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 176
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/4 complete
Random level 1, 2/4 complete
Random level 2, 3/4 complete
Random level 3, 4/4 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 440/4400
row: 880/4400
row: 1320/4400
row: 1760/4400
row: 2200/4400
row: 2640/4400
row: 3080/4400
row: 3520/4400
row: 3960/4400
row: 4390/4400
Extrapolated 'none' rows
Took log of observed counts
Arc
Bcl11b
Camk2a
Dlx2
Fezf2
Grin2a
Ncdn
Nptxr
Nr4a2
Rorb
Satb2
Estimated change points with LROcp and found initial baseline parameters
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Constructed grouping variable ids
Computed size of rRsum boundary vector: 1259
Finished initializing wspc object


Estimating model paarameters: 
---------------


Running bootstrap fits (forking): 
Batch 0/100, 0.235621 sec/bs
Batch 1/100, 0.188693 sec/bs
Batch 2/100, 0.234601 sec/bs
Batch 3/100, 0.218023 sec/bs
Batch 4/100, 0.155061 sec/bs
Batch 5/100, 0.285922 sec/bs
Batch 6/100, 0.198196 sec/bs
Batch 7/100, 0.222708 sec/bs
Batch 8/100, 0.238562 sec/bs
Batch 9/100, 0.210073 sec/bs
Batch 10/100, 0.21026 sec/bs
Batch 11/100, 0.261491 sec/bs
Batch 12/100, 0.194688 sec/bs
Batch 13/100, 0.193977 sec/bs
Batch 14/100, 0.184382 sec/bs
Batch 15/100, 0.198861 sec/bs
Batch 16/100, 0.195775 sec/bs
Batch 17/100, 0.27619 sec/bs
Batch 18/100, 0.277571 sec/bs
Batch 19/100, 0.209794 sec/bs
Batch 20/100, 0.165638 sec/bs
Batch 21/100, 0.281467 sec/bs
Batch 22/100, 0.241604 sec/bs
Batch 23/100, 0.189504 sec/bs
Batch 24/100, 0.265816 sec/bs
Batch 25/100, 0.182802 sec/bs
Batch 26/100, 0.188808 sec/bs
Batch 27/100, 0.186175 sec/bs
Batch 28/100, 0.157168 sec/bs
Batch 29/100, 0.234826 sec/bs
Batch 30/100, 0.237767 sec/bs
Batch 31/100, 0.190947 sec/bs
Batch 32/100, 0.260668 sec/bs
Batch 33/100, 0.193775 sec/bs
Batch 34/100, 0.206387 sec/bs
Batch 35/100, 0.208454 sec/bs
Batch 36/100, 0.200783 sec/bs
Batch 37/100, 0.160757 sec/bs
Batch 38/100, 0.162013 sec/bs
Batch 39/100, 0.174787 sec/bs
Batch 40/100, 0.249913 sec/bs
Batch 41/100, 0.181517 sec/bs
Batch 42/100, 0.203006 sec/bs
Batch 43/100, 0.153303 sec/bs
Batch 44/100, 0.261322 sec/bs
Batch 45/100, 0.208919 sec/bs
Batch 46/100, 0.240473 sec/bs
Batch 47/100, 0.240123 sec/bs
Batch 48/100, 0.16325 sec/bs
Batch 49/100, 0.193209 sec/bs
Batch 50/100, 0.195207 sec/bs
Batch 51/100, 0.192478 sec/bs
Batch 52/100, 0.225317 sec/bs
Batch 53/100, 0.187734 sec/bs
Batch 54/100, 0.220664 sec/bs
Batch 55/100, 0.195354 sec/bs
Batch 56/100, 0.239195 sec/bs
Batch 57/100, 0.224849 sec/bs
Batch 58/100, 0.210641 sec/bs
Batch 59/100, 0.204988 sec/bs
Batch 60/100, 0.16207 sec/bs
Batch 61/100, 0.2406 sec/bs
Batch 62/100, 0.151517 sec/bs
Batch 63/100, 0.214005 sec/bs
Batch 64/100, 0.263434 sec/bs
Batch 65/100, 0.214893 sec/bs
Batch 66/100, 0.216343 sec/bs
Batch 67/100, 0.227453 sec/bs
Batch 68/100, 0.23734 sec/bs
Batch 69/100, 0.163689 sec/bs
Batch 70/100, 0.272126 sec/bs
Batch 71/100, 0.201879 sec/bs
Batch 72/100, 0.28331 sec/bs
Batch 73/100, 0.212569 sec/bs
Batch 74/100, 0.180675 sec/bs
Batch 75/100, 0.216158 sec/bs
Batch 76/100, 0.19302 sec/bs
Batch 77/100, 0.226992 sec/bs
Batch 78/100, 0.19819 sec/bs
Batch 79/100, 0.195811 sec/bs
Batch 80/100, 0.282552 sec/bs
Batch 81/100, 0.224398 sec/bs
Batch 82/100, 0.189005 sec/bs
Batch 83/100, 0.19712 sec/bs
Batch 84/100, 0.236114 sec/bs
Batch 85/100, 0.199537 sec/bs
Batch 86/100, 0.24486 sec/bs
Batch 87/100, 0.159471 sec/bs
Batch 88/100, 0.282728 sec/bs
Batch 89/100, 0.260028 sec/bs
Batch 90/100, 0.178184 sec/bs
Batch 91/100, 0.270058 sec/bs
Batch 92/100, 0.222227 sec/bs
Batch 93/100, 0.190867 sec/bs
Batch 94/100, 0.192137 sec/bs
Batch 95/100, 0.18184 sec/bs
Batch 96/100, 0.227509 sec/bs
Batch 97/100, 0.198818 sec/bs
Batch 98/100, 0.230571 sec/bs
Batch 99/100, 0.177207 sec/bs
All complete!

Setting median bootstrap estimates as parameters... 
Checking feasibility of provided parameters
Provided parameters are feasible


Running stats on bootstrap results: 
----------------------------------------

Grabbing bootstrap results, all resamples... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from bootstraped parameters... 

Stat summary (head only):
------------------------------
                              parameter    estimate      CI.low     CI.high
1       baseline_cortex_Rt_Arc_Tns/Blk1  8.11920507  8.11658075  8.12263826
2   beta_Rt_cortex_Arc_right_X_Tns/Blk1 -0.04434121 -0.04556218 -0.04328136
3      beta_Rt_cortex_Arc_18_X_Tns/Blk1 -0.05793907 -0.05895215 -0.05698360
4 beta_Rt_cortex_Arc_right18_X_Tns/Blk1 -0.04733714 -0.04838619 -0.04645599
5       baseline_cortex_Rt_Arc_Tns/Blk2  7.15863635  7.15536601  7.16260155
6   beta_Rt_cortex_Arc_right_X_Tns/Blk2 -0.04420185 -0.04567093 -0.04279267
  p.value p.value.adj    alpha.adj significance
1       0           0 0.0001858736          ***
2      NA          NA           NA             
3      NA          NA           NA             
4      NA          NA           NA             
5       0           0 0.0001865672          ***
6      NA          NA           NA             
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group     mean       sd variance
1 cortex_Satb2 1.028904 1.314951 1.729097
----

Can't make TPS table without running stats... 

Printing structural summary distributions: 
----------------------------------------

Warping factors, beta distributions... 
Rate effects, gamma distribution... 
Slope effects, gamma distribution... 
tpoint effects, Gaussian distribution... 
Making rate-count plots... 
Printing child summary plots: 
----------------------------------------


Making summary plots for cortex: Arc, Bcl11b, Camk2a, Dlx2, Fezf2, Grin2a, Ncdn, Nptxr, Nr4a2, Rorb, Satb2