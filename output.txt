

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 4 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P12_z0-3_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 4: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.722, 1.902, 0.897, 1.216
Mean of means: 1.434
Standard deviation of means: 0.461

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA     CNU-HYa GABA     CNU-MGE GABA CTX-CGE/MGE GABA         filtered          HY GABA           Immune       IT-ET Glut         LSX GABA          MB GABA       MH-LH Glut          MY GABA   NP-CT-L6b Glut      OB-IMN GABA              OEC        OPC-Oligo 
            1255               24               12                7              652             6917               14              122             7388               12               18                9              203             1365               51               16              242 
          P GABA  TSCRPT_filtered         Vascular          CB Glut     CNU-LGE GABA      DG-IMN Glut          MY Glut       OB-CR Glut          TH Glut     CNU-HYa Glut    HY Gnrh1 Glut          MB Dopa           P Glut      Pineal Glut       MB-HB Sero 
              68                6             2015               19                4                7                2                0                1                1                2                2                2                5                1 
----

Number of mice: 4
Cells per mouse: 4734, 5759, 4514, 5435
Means cells per mouse: 5110.5
Total cells: 20442

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Initializing Cpp (wspc) model: 
----------------------------------------

Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Arc" "Bcl11b" "Camk2a" "Dlx2" "Fezf2" "Grin2a" "Ncdn" "Nptxr" "Nr4a2" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 22000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 220
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 440/4400
row: 880/4400
row: 1320/4400
row: 1760/4400
row: 2200/4400
row: 2640/4400
row: 3080/4400
row: 3520/4400
row: 3960/4400
row: 4390/4400
Extrapolated 'none' rows
Took log of observed counts
Found mean observed ran effect per ran level
------
vec: 7 66 100 
vec: 7 59 34 
Max block size: 59
Max block size index: 1
vec: 7 37 66 100 
------
vec: 7 37 66 100 
vec: 7 30 29 34 
Max block size: 34
Max block size index: 3
vec: 7 37 66 83 100 
------
vec: 7 37 66 83 100 
vec: 7 30 29 17 17 
Max block size: 30
Max block size index: 1
vec: 7 22 37 66 83 100 
------
vec: 11 44 65 78 100 
vec: 11 33 21 13 22 
Max block size: 33
Max block size index: 1
vec: 11 28 44 65 78 100 
------
vec: 28 64 100 
vec: 28 36 36 
Max block size: 36
Max block size index: 1
vec: 28 46 64 100 
------
vec: 28 46 64 100 
vec: 28 18 18 36 
Max block size: 36
Max block size index: 3
vec: 28 46 64 82 100 
------
vec: 28 46 64 82 100 
vec: 28 18 18 18 18 
Max block size: 28
Max block size index: 0
vec: 14 28 46 64 82 100 
------
vec: 7 61 71 100 
vec: 7 54 10 29 
Max block size: 54
Max block size index: 1
vec: 7 34 61 71 100 
------
vec: 7 34 61 71 100 
vec: 7 27 27 10 29 
Max block size: 29
Max block size index: 4
vec: 7 34 61 71 86 100 
------
vec: 16 56 64 100 
vec: 16 40 8 36 
Max block size: 40
Max block size index: 1
vec: 16 36 56 64 100 
------
vec: 16 36 56 64 100 
vec: 16 20 20 8 36 
Max block size: 36
Max block size index: 4
vec: 16 36 56 64 82 100 
------
vec: 64 100 
vec: 64 36 
Max block size: 64
Max block size index: 0
vec: 32 64 100 
------
vec: 32 64 100 
vec: 32 32 36 
Max block size: 36
Max block size index: 2
vec: 32 64 82 100 
------
vec: 32 64 82 100 
vec: 32 32 18 18 
Max block size: 32
Max block size index: 0
vec: 16 32 64 82 100 
------
vec: 16 32 64 82 100 
vec: 16 16 32 18 18 
Max block size: 32
Max block size index: 2
vec: 16 32 48 64 82 100 
------
vec: 17 67 100 
vec: 17 50 33 
Max block size: 50
Max block size index: 1
vec: 17 42 67 100 
------
vec: 17 42 67 100 
vec: 17 25 25 33 
Max block size: 33
Max block size index: 3
vec: 17 42 67 84 100 
------
vec: 17 42 67 84 100 
vec: 17 25 25 17 16 
Max block size: 25
Max block size index: 1
vec: 17 30 42 67 84 100 
------
vec: 19 47 64 100 
vec: 19 28 17 36 
Max block size: 36
Max block size index: 3
vec: 19 47 64 82 100 
------
vec: 19 47 64 82 100 
vec: 19 28 17 18 18 
Max block size: 28
Max block size index: 1
vec: 19 33 47 64 82 100 
------
vec: 47 84 100 
vec: 47 37 16 
Max block size: 47
Max block size index: 0
vec: 24 47 84 100 
------
vec: 24 47 84 100 
vec: 24 23 37 16 
Max block size: 37
Max block size index: 2
vec: 24 47 66 84 100 
------
vec: 24 47 66 84 100 
vec: 24 23 19 18 16 
Max block size: 24
Max block size index: 0
vec: 12 24 47 66 84 100 
------
vec: 45 100 
vec: 45 55 
Max block size: 55
Max block size index: 1
vec: 45 73 100 
------
vec: 45 73 100 
vec: 45 28 27 
Max block size: 45
Max block size index: 0
vec: 23 45 73 100 
------
vec: 23 45 73 100 
vec: 23 22 28 27 
Max block size: 28
Max block size index: 2
vec: 23 45 59 73 100 
------
vec: 23 45 59 73 100 
vec: 23 22 14 14 27 
Max block size: 27
Max block size index: 4
vec: 23 45 59 73 87 100 
vec: 9 25 40 65 80 
vec: 11 30 48 63 84 
vec: 16 32 48 65 82 
vec: 18 34 51 67 84 
------
vec: 7 24 100 
vec: 7 17 76 
Max block size: 76
Max block size index: 2
vec: 7 24 62 100 
------
vec: 11 100 
vec: 11 89 
Max block size: 89
Max block size index: 1
vec: 11 56 100 
------
vec: 11 56 100 
vec: 11 45 44 
Max block size: 45
Max block size index: 1
vec: 11 34 56 100 
------
vec: 30 36 100 
vec: 30 6 64 
Max block size: 64
Max block size index: 2
vec: 30 36 68 100 
------
vec: 14 21 100 
vec: 14 7 79 
Max block size: 79
Max block size index: 2
vec: 14 21 61 100 
------
vec: 39 88 100 
vec: 39 49 12 
Max block size: 49
Max block size index: 1
vec: 39 64 88 100 
------
vec: 15 23 100 
vec: 15 8 77 
Max block size: 77
Max block size index: 2
vec: 15 23 62 100 
------
vec: 12 18 100 
vec: 12 6 82 
Max block size: 82
Max block size index: 2
vec: 12 18 59 100 
------
vec: 15 49 100 
vec: 15 34 51 
Max block size: 51
Max block size index: 2
vec: 15 49 75 100 
------
vec: 21 75 89 100 
vec: 21 54 14 11 
Max block size: 54
Max block size index: 1
vec: 21 48 75 89 100 
------
vec: 63 70 84 100 
vec: 63 7 14 16 
Max block size: 63
Max block size index: 0
vec: 32 63 70 84 100 
------
vec: 33 71 100 
vec: 33 38 29 
Max block size: 38
Max block size index: 1
vec: 33 52 71 100 
------
vec: 33 52 71 100 
vec: 33 19 19 29 
Max block size: 33
Max block size index: 0
vec: 17 33 52 71 100 
------
vec: 33 59 77 100 
vec: 33 26 18 23 
Max block size: 33
Max block size index: 0
vec: 17 33 59 77 100 
------
vec: 9 23 53 100 
vec: 9 14 30 47 
Max block size: 47
Max block size index: 3
vec: 9 23 53 77 100 
------
vec: 81 100 
vec: 81 19 
Max block size: 81
Max block size index: 0
vec: 41 81 100 
------
vec: 41 81 100 
vec: 41 40 19 
Max block size: 41
Max block size index: 0
vec: 21 41 81 100 
------
vec: 21 41 81 100 
vec: 21 20 40 19 
Max block size: 40
Max block size index: 2
vec: 21 41 61 81 100 
------
vec: 70 76 88 100 
vec: 70 6 12 12 
Max block size: 70
Max block size index: 0
vec: 35 70 76 88 100 
------
vec: 23 100 
vec: 23 77 
Max block size: 77
Max block size index: 1
vec: 23 62 100 
------
vec: 23 62 100 
vec: 23 39 38 
Max block size: 39
Max block size index: 1
vec: 23 43 62 100 
------
vec: 23 43 62 100 
vec: 23 20 19 38 
Max block size: 38
Max block size index: 3
vec: 23 43 62 81 100 
------
vec: 74 100 
vec: 74 26 
Max block size: 74
Max block size index: 0
vec: 37 74 100 
------
vec: 37 74 100 
vec: 37 37 26 
Max block size: 37
Max block size index: 0
vec: 19 37 74 100 
------
vec: 19 37 74 100 
vec: 19 18 37 26 
Max block size: 37
Max block size index: 2
vec: 19 37 56 74 100 
------
vec: 79 100 
vec: 79 21 
Max block size: 79
Max block size index: 0
vec: 40 79 100 
------
vec: 40 79 100 
vec: 40 39 21 
Max block size: 40
Max block size index: 0
vec: 20 40 79 100 
------
vec: 20 40 79 100 
vec: 20 20 39 21 
Max block size: 39
Max block size index: 2
vec: 20 40 60 79 100 
------
vec: 43 54 80 100 
vec: 43 11 26 20 
Max block size: 43
Max block size index: 0
vec: 22 43 54 80 100 
------
vec: 54 84 100 
vec: 54 30 16 
Max block size: 54
Max block size index: 0
vec: 27 54 84 100 
------
vec: 26 67 100 
vec: 26 41 33 
Max block size: 41
Max block size index: 1
vec: 26 47 67 100 
------
vec: 49 86 100 
vec: 49 37 14 
Max block size: 49
Max block size index: 0
vec: 25 49 86 100 
------
vec: 86 100 
vec: 86 14 
Max block size: 86
Max block size index: 0
vec: 43 86 100 
------
vec: 43 86 100 
vec: 43 43 14 
Max block size: 43
Max block size index: 0
vec: 22 43 86 100 
------
vec: 57 100 
vec: 57 43 
Max block size: 57
Max block size index: 0
vec: 29 57 100 
------
vec: 29 57 100 
vec: 29 28 43 
Max block size: 43
Max block size index: 2
vec: 29 57 79 100 
------
vec: 20 100 
vec: 20 80 
Max block size: 80
Max block size index: 1
vec: 20 60 100 
------
vec: 20 60 100 
vec: 20 40 40 
Max block size: 40
Max block size index: 1
vec: 20 40 60 100 
------
vec: 56 100 
vec: 56 44 
Max block size: 56
Max block size index: 0
vec: 28 56 100 
------
vec: 28 56 100 
vec: 28 28 44 
Max block size: 44
Max block size index: 2
vec: 28 56 78 100 
------
vec: 66 100 
vec: 66 34 
Max block size: 66
Max block size index: 0
vec: 33 66 100 
------
vec: 33 66 100 
vec: 33 33 34 
Max block size: 34
Max block size index: 2
vec: 33 66 83 100 
------
vec: 13 24 100 
vec: 13 11 76 
Max block size: 76
Max block size index: 2
vec: 13 24 62 100 
------
vec: 13 24 62 100 
vec: 13 11 38 38 
Max block size: 38
Max block size index: 2
vec: 13 24 43 62 100 
------
vec: 7 24 34 100 
vec: 7 17 10 66 
Max block size: 66
Max block size index: 3
vec: 7 24 34 67 100 
------
vec: 32 100 
vec: 32 68 
Max block size: 68
Max block size index: 1
vec: 32 66 100 
------
vec: 32 66 100 
vec: 32 34 34 
Max block size: 34
Max block size index: 1
vec: 32 49 66 100 
------
vec: 32 49 66 100 
vec: 32 17 17 34 
Max block size: 34
Max block size index: 3
vec: 32 49 66 83 100 
------
vec: 12 20 41 100 
vec: 12 8 21 59 
Max block size: 59
Max block size index: 3
vec: 12 20 41 71 100 
------
vec: 17 34 100 
vec: 17 17 66 
Max block size: 66
Max block size index: 2
vec: 17 34 67 100 
------
vec: 17 34 67 100 
vec: 17 17 33 33 
Max block size: 33
Max block size index: 2
vec: 17 34 51 67 100 
------
vec: 20 34 40 100 
vec: 20 14 6 60 
Max block size: 60
Max block size index: 3
vec: 20 34 40 70 100 
------
vec: 21 28 34 100 
vec: 21 7 6 66 
Max block size: 66
Max block size index: 3
vec: 21 28 34 67 100 
------
vec: 36 63 100 
vec: 36 27 37 
Max block size: 37
Max block size index: 2
vec: 36 63 82 100 
------
vec: 36 63 82 100 
vec: 36 27 19 18 
Max block size: 36
Max block size index: 0
vec: 18 36 63 82 100 
------
vec: 36 100 
vec: 36 64 
Max block size: 64
Max block size index: 1
vec: 36 68 100 
------
vec: 36 68 100 
vec: 36 32 32 
Max block size: 36
Max block size index: 0
vec: 18 36 68 100 
------
vec: 18 36 68 100 
vec: 18 18 32 32 
Max block size: 32
Max block size index: 2
vec: 18 36 52 68 100 
------
vec: 10 18 36 68 100 
vec: 10 8 18 32 32 
Max block size: 32
Max block size index: 3
vec: 10 18 36 52 68 100 
------
vec: 10 18 36 52 68 100 
vec: 10 8 18 16 16 32 
Max block size: 32
Max block size index: 5
vec: 10 18 36 52 68 84 100 
------
vec: 76 100 
vec: 76 24 
Max block size: 76
Max block size index: 0
vec: 38 76 100 
------
vec: 38 76 100 
vec: 38 38 24 
Max block size: 38
Max block size index: 0
vec: 19 38 76 100 
------
vec: 19 38 76 100 
vec: 19 19 38 24 
Max block size: 38
Max block size index: 2
vec: 19 38 57 76 100 
------
vec: 19 38 57 76 100 
vec: 19 19 19 19 24 
Max block size: 24
Max block size index: 4
vec: 19 38 57 76 88 100 
------
vec: 19 38 57 76 88 100 
vec: 19 19 19 19 12 12 
Max block size: 19
Max block size index: 0
vec: 10 19 38 57 76 88 100 
------
vec: 31 100 
vec: 31 69 
Max block size: 69
Max block size index: 1
vec: 31 66 100 
------
vec: 31 66 100 
vec: 31 35 34 
Max block size: 35
Max block size index: 1
vec: 31 49 66 100 
------
vec: 31 49 66 100 
vec: 31 18 17 34 
Max block size: 34
Max block size index: 3
vec: 31 49 66 83 100 
------
vec: 31 49 66 83 100 
vec: 31 18 17 17 17 
Max block size: 31
Max block size index: 0
vec: 16 31 49 66 83 100 
------
vec: 16 31 49 66 83 100 
vec: 16 15 18 17 17 17 
Max block size: 18
Max block size index: 2
vec: 16 31 40 49 66 83 100 
------
vec: 31 77 100 
vec: 31 46 23 
Max block size: 46
Max block size index: 1
vec: 31 54 77 100 
------
vec: 31 54 77 100 
vec: 31 23 23 23 
Max block size: 31
Max block size index: 0
vec: 16 31 54 77 100 
------
vec: 16 31 54 77 100 
vec: 16 15 23 23 23 
Max block size: 23
Max block size index: 2
vec: 16 31 43 54 77 100 
------
vec: 16 31 43 54 77 100 
vec: 16 15 12 11 23 23 
Max block size: 23
Max block size index: 4
vec: 16 31 43 54 66 77 100 
------
vec: 20 45 74 100 
vec: 20 25 29 26 
Max block size: 29
Max block size index: 2
vec: 20 45 60 74 100 
------
vec: 20 45 60 74 100 
vec: 20 25 15 14 26 
Max block size: 26
Max block size index: 4
vec: 20 45 60 74 87 100 
------
vec: 20 45 60 74 87 100 
vec: 20 25 15 14 13 13 
Max block size: 25
Max block size index: 1
vec: 20 33 45 60 74 87 100 
------
vec: 12 34 52 65 100 
vec: 12 22 18 13 35 
Max block size: 35
Max block size index: 4
vec: 12 34 52 65 83 100 
------
vec: 12 34 52 65 83 100 
vec: 12 22 18 13 18 17 
Max block size: 22
Max block size index: 1
vec: 12 23 34 52 65 83 100 
------
vec: 75 100 
vec: 75 25 
Max block size: 75
Max block size index: 0
vec: 38 75 100 
------
vec: 38 75 100 
vec: 38 37 25 
Max block size: 38
Max block size index: 0
vec: 19 38 75 100 
------
vec: 19 38 75 100 
vec: 19 19 37 25 
Max block size: 37
Max block size index: 2
vec: 19 38 57 75 100 
------
vec: 19 38 57 75 100 
vec: 19 19 19 18 25 
Max block size: 25
Max block size index: 4
vec: 19 38 57 75 88 100 
------
vec: 19 38 57 75 88 100 
vec: 19 19 19 18 13 12 
Max block size: 19
Max block size index: 0
vec: 10 19 38 57 75 88 100 
------
vec: 17 33 68 100 
vec: 17 16 35 32 
Max block size: 35
Max block size index: 2
vec: 17 33 51 68 100 
------
vec: 17 33 51 68 100 
vec: 17 16 18 17 32 
Max block size: 32
Max block size index: 4
vec: 17 33 51 68 84 100 
------
vec: 17 33 51 68 84 100 
vec: 17 16 18 17 16 16 
Max block size: 18
Max block size index: 2
vec: 17 33 42 51 68 84 100 
------
vec: 21 74 80 100 
vec: 21 53 6 20 
Max block size: 53
Max block size index: 1
vec: 21 48 74 80 100 
------
vec: 21 48 74 80 100 
vec: 21 27 26 6 20 
Max block size: 27
Max block size index: 1
vec: 21 35 48 74 80 100 
------
vec: 21 35 48 74 80 100 
vec: 21 14 13 26 6 20 
Max block size: 26
Max block size index: 3
vec: 21 35 48 61 74 80 100 
------
vec: 78 100 
vec: 78 22 
Max block size: 78
Max block size index: 0
vec: 39 78 100 
------
vec: 39 78 100 
vec: 39 39 22 
Max block size: 39
Max block size index: 0
vec: 20 39 78 100 
------
vec: 20 39 78 100 
vec: 20 19 39 22 
Max block size: 39
Max block size index: 2
vec: 20 39 59 78 100 
------
vec: 20 39 59 78 100 
vec: 20 19 20 19 22 
Max block size: 22
Max block size index: 4
vec: 20 39 59 78 89 100 
------
vec: 20 39 59 78 89 100 
vec: 20 19 20 19 11 11 
Max block size: 20
Max block size index: 0
vec: 10 20 39 59 78 89 100 
------
vec: 72 78 100 
vec: 72 6 22 
Max block size: 72
Max block size index: 0
vec: 36 72 78 100 
------
vec: 36 72 78 100 
vec: 36 36 6 22 
Max block size: 36
Max block size index: 0
vec: 18 36 72 78 100 
------
vec: 18 36 72 78 100 
vec: 18 18 36 6 22 
Max block size: 36
Max block size index: 2
vec: 18 36 54 72 78 100 
------
vec: 18 36 54 72 78 100 
vec: 18 18 18 18 6 22 
Max block size: 22
Max block size index: 5
vec: 18 36 54 72 78 89 100 
------
vec: 18 70 100 
vec: 18 52 30 
Max block size: 52
Max block size index: 1
vec: 18 44 70 100 
------
vec: 18 44 70 100 
vec: 18 26 26 30 
Max block size: 30
Max block size index: 3
vec: 18 44 70 85 100 
------
vec: 18 44 70 85 100 
vec: 18 26 26 15 15 
Max block size: 26
Max block size index: 1
vec: 18 31 44 70 85 100 
------
vec: 9 46 69 100 
vec: 9 37 23 31 
Max block size: 37
Max block size index: 1
vec: 9 28 46 69 100 
------
vec: 9 28 46 69 100 
vec: 9 19 18 23 31 
Max block size: 31
Max block size index: 4
vec: 9 28 46 69 85 100 
------
vec: 23 67 100 
vec: 23 44 33 
Max block size: 44
Max block size index: 1
vec: 23 45 67 100 
------
vec: 23 45 67 100 
vec: 23 22 22 33 
Max block size: 33
Max block size index: 3
vec: 23 45 67 84 100 
------
vec: 23 45 67 84 100 
vec: 23 22 22 17 16 
Max block size: 23
Max block size index: 0
vec: 12 23 45 67 84 100 
------
vec: 26 52 72 100 
vec: 26 26 20 28 
Max block size: 28
Max block size index: 3
vec: 26 52 72 86 100 
------
vec: 26 52 72 86 100 
vec: 26 26 20 14 14 
Max block size: 26
Max block size index: 0
vec: 13 26 52 72 86 100 
------
vec: 47 77 100 
vec: 47 30 23 
Max block size: 47
Max block size index: 0
vec: 24 47 77 100 
------
vec: 24 47 77 100 
vec: 24 23 30 23 
Max block size: 30
Max block size index: 2
vec: 24 47 62 77 100 
------
vec: 24 47 62 77 100 
vec: 24 23 15 15 23 
Max block size: 24
Max block size index: 0
vec: 12 24 47 62 77 100 
------
vec: 46 61 70 78 100 
vec: 46 15 9 8 22 
Max block size: 46
Max block size index: 0
vec: 23 46 61 70 78 100 
------
vec: 7 14 100 
vec: 7 7 86 
Max block size: 86
Max block size index: 2
vec: 7 14 57 100 
------
vec: 7 14 57 100 
vec: 7 7 43 43 
Max block size: 43
Max block size index: 2
vec: 7 14 36 57 100 
------
vec: 7 14 36 57 100 
vec: 7 7 22 21 43 
Max block size: 43
Max block size index: 4
vec: 7 14 36 57 79 100 
------
vec: 57 68 100 
vec: 57 11 32 
Max block size: 57
Max block size index: 0
vec: 29 57 68 100 
------
vec: 29 57 68 100 
vec: 29 28 11 32 
Max block size: 32
Max block size index: 3
vec: 29 57 68 84 100 
------
vec: 29 57 68 84 100 
vec: 29 28 11 16 16 
Max block size: 29
Max block size index: 0
vec: 15 29 57 68 84 100 
------
vec: 43 52 66 83 100 
vec: 43 9 14 17 17 
Max block size: 43
Max block size index: 0
vec: 22 43 52 66 83 100 
------
vec: 79 100 
vec: 79 21 
Max block size: 79
Max block size index: 0
vec: 40 79 100 
------
vec: 40 79 100 
vec: 40 39 21 
Max block size: 40
Max block size index: 0
vec: 20 40 79 100 
------
vec: 20 40 79 100 
vec: 20 20 39 21 
Max block size: 39
Max block size index: 2
vec: 20 40 60 79 100 
------
vec: 20 40 60 79 100 
vec: 20 20 20 19 21 
Max block size: 21
Max block size index: 4
vec: 20 40 60 79 90 100 
------
vec: 46 59 69 100 
vec: 46 13 10 31 
Max block size: 46
Max block size index: 0
vec: 23 46 59 69 100 
------
vec: 23 46 59 69 100 
vec: 23 23 13 10 31 
Max block size: 31
Max block size index: 4
vec: 23 46 59 69 85 100 
------
vec: 55 100 
vec: 55 45 
Max block size: 55
Max block size index: 0
vec: 28 55 100 
------
vec: 28 55 100 
vec: 28 27 45 
Max block size: 45
Max block size index: 2
vec: 28 55 78 100 
------
vec: 68 100 
vec: 68 32 
Max block size: 68
Max block size index: 0
vec: 34 68 100 
------
vec: 34 68 100 
vec: 34 34 32 
Max block size: 34
Max block size index: 0
vec: 17 34 68 100 
------
vec: 65 77 100 
vec: 65 12 23 
Max block size: 65
Max block size index: 0
vec: 33 65 77 100 
------
vec: 78 88 100 
vec: 78 10 12 
Max block size: 78
Max block size index: 0
vec: 39 78 88 100 
------
vec: 78 100 
vec: 78 22 
Max block size: 78
Max block size index: 0
vec: 39 78 100 
------
vec: 39 78 100 
vec: 39 39 22 
Max block size: 39
Max block size index: 0
vec: 20 39 78 100 
------
vec: 8 21 56 89 100 
vec: 8 13 35 33 11 
Max block size: 35
Max block size index: 2
vec: 8 21 39 56 89 100 
------
vec: 10 100 
vec: 10 90 
Max block size: 90
Max block size index: 1
vec: 10 55 100 
------
vec: 10 55 100 
vec: 10 45 45 
Max block size: 45
Max block size index: 1
vec: 10 33 55 100 
------
vec: 10 33 55 100 
vec: 10 23 22 45 
Max block size: 45
Max block size index: 3
vec: 10 33 55 78 100 
------
vec: 10 33 55 78 100 
vec: 10 23 22 23 22 
Max block size: 23
Max block size index: 1
vec: 10 22 33 55 78 100 
------
vec: 20 52 100 
vec: 20 32 48 
Max block size: 48
Max block size index: 2
vec: 20 52 76 100 
------
vec: 20 52 76 100 
vec: 20 32 24 24 
Max block size: 32
Max block size index: 1
vec: 20 36 52 76 100 
------
vec: 20 36 52 76 100 
vec: 20 16 16 24 24 
Max block size: 24
Max block size index: 3
vec: 20 36 52 64 76 100 
------
vec: 15 46 77 100 
vec: 15 31 31 23 
Max block size: 31
Max block size index: 1
vec: 15 31 46 77 100 
------
vec: 15 31 46 77 100 
vec: 15 16 15 31 23 
Max block size: 31
Max block size index: 3
vec: 15 31 46 62 77 100 
------
vec: 34 48 67 77 100 
vec: 34 14 19 10 23 
Max block size: 34
Max block size index: 0
vec: 17 34 48 67 77 100 
------
vec: 7 18 53 100 
vec: 7 11 35 47 
Max block size: 47
Max block size index: 3
vec: 7 18 53 77 100 
------
vec: 7 18 53 77 100 
vec: 7 11 35 24 23 
Max block size: 35
Max block size index: 2
vec: 7 18 36 53 77 100 
------
vec: 20 60 91 100 
vec: 20 40 31 9 
Max block size: 40
Max block size index: 1
vec: 20 40 60 91 100 
------
vec: 20 40 60 91 100 
vec: 20 20 20 31 9 
Max block size: 31
Max block size index: 3
vec: 20 40 60 76 91 100 
------
vec: 9 24 100 
vec: 9 15 76 
Max block size: 76
Max block size index: 2
vec: 9 24 62 100 
------
vec: 9 24 62 100 
vec: 9 15 38 38 
Max block size: 38
Max block size index: 2
vec: 9 24 43 62 100 
------
vec: 9 24 43 62 100 
vec: 9 15 19 19 38 
Max block size: 38
Max block size index: 4
vec: 9 24 43 62 81 100 
------
vec: 13 20 100 
vec: 13 7 80 
Max block size: 80
Max block size index: 2
vec: 13 20 60 100 
------
vec: 13 20 60 100 
vec: 13 7 40 40 
Max block size: 40
Max block size index: 2
vec: 13 20 40 60 100 
------
vec: 13 20 40 60 100 
vec: 13 7 20 20 40 
Max block size: 40
Max block size index: 4
vec: 13 20 40 60 80 100 
------
vec: 30 46 58 89 100 
vec: 30 16 12 31 11 
Max block size: 31
Max block size index: 3
vec: 30 46 58 74 89 100 
------
vec: 10 18 27 100 
vec: 10 8 9 73 
Max block size: 73
Max block size index: 3
vec: 10 18 27 64 100 
------
vec: 10 18 27 64 100 
vec: 10 8 9 37 36 
Max block size: 37
Max block size index: 3
vec: 10 18 27 46 64 100 
------
vec: 55 81 100 
vec: 55 26 19 
Max block size: 55
Max block size index: 0
vec: 28 55 81 100 
------
vec: 17 57 100 
vec: 17 40 43 
Max block size: 43
Max block size index: 2
vec: 17 57 79 100 
------
vec: 63 69 100 
vec: 63 6 31 
Max block size: 63
Max block size index: 0
vec: 32 63 69 100 
------
vec: 60 80 100 
vec: 60 20 20 
Max block size: 60
Max block size index: 0
vec: 30 60 80 100 
------
vec: 10 46 100 
vec: 10 36 54 
Max block size: 54
Max block size index: 2
vec: 10 46 73 100 
------
vec: 52 68 100 
vec: 52 16 32 
Max block size: 52
Max block size index: 0
vec: 26 52 68 100 
------
vec: 52 100 
vec: 52 48 
Max block size: 52
Max block size index: 0
vec: 26 52 100 
------
vec: 26 52 100 
vec: 26 26 48 
Max block size: 48
Max block size index: 2
vec: 26 52 76 100 
------
vec: 68 100 
vec: 68 32 
Max block size: 68
Max block size index: 0
vec: 34 68 100 
------
vec: 34 68 100 
vec: 34 34 32 
Max block size: 34
Max block size index: 0
vec: 17 34 68 100 
------
vec: 66 87 100 
vec: 66 21 13 
Max block size: 66
Max block size index: 0
vec: 33 66 87 100 
------
vec: 46 67 100 
vec: 46 21 33 
Max block size: 46
Max block size index: 0
vec: 23 46 67 100 
------
vec: 38 45 100 
vec: 38 7 55 
Max block size: 55
Max block size index: 2
vec: 38 45 73 100 
------
vec: 38 45 73 100 
vec: 38 7 28 27 
Max block size: 38
Max block size index: 0
vec: 19 38 45 73 100 
------
vec: 38 45 100 
vec: 38 7 55 
Max block size: 55
Max block size index: 2
vec: 38 45 73 100 
------
vec: 38 45 73 100 
vec: 38 7 28 27 
Max block size: 38
Max block size index: 0
vec: 19 38 45 73 100 
------
vec: 32 46 82 100 
vec: 32 14 36 18 
Max block size: 36
Max block size index: 2
vec: 32 46 64 82 100 
------
vec: 28 78 85 100 
vec: 28 50 7 15 
Max block size: 50
Max block size index: 1
vec: 28 53 78 85 100 
------
vec: 20 77 100 
vec: 20 57 23 
Max block size: 57
Max block size index: 1
vec: 20 49 77 100 
------
vec: 20 49 77 100 
vec: 20 29 28 23 
Max block size: 29
Max block size index: 1
vec: 20 35 49 77 100 
------
vec: 10 100 
vec: 10 90 
Max block size: 90
Max block size index: 1
vec: 10 55 100 
------
vec: 10 55 100 
vec: 10 45 45 
Max block size: 45
Max block size index: 1
vec: 10 33 55 100 
------
vec: 10 33 55 100 
vec: 10 23 22 45 
Max block size: 45
Max block size index: 3
vec: 10 33 55 78 100 
------
vec: 48 59 100 
vec: 48 11 41 
Max block size: 48
Max block size index: 0
vec: 24 48 59 100 
------
vec: 24 48 59 100 
vec: 24 24 11 41 
Max block size: 41
Max block size index: 3
vec: 24 48 59 80 100 
------
vec: 18 48 88 100 
vec: 18 30 40 12 
Max block size: 40
Max block size index: 2
vec: 18 48 68 88 100 
------
vec: 28 100 
vec: 28 72 
Max block size: 72
Max block size index: 1
vec: 28 64 100 
------
vec: 28 64 100 
vec: 28 36 36 
Max block size: 36
Max block size index: 1
vec: 28 46 64 100 
------
vec: 28 46 64 100 
vec: 28 18 18 36 
Max block size: 36
Max block size index: 3
vec: 28 46 64 82 100 
------
vec: 17 23 40 100 
vec: 17 6 17 60 
Max block size: 60
Max block size index: 3
vec: 17 23 40 70 100 
Estimated change points with LROcp and found initial parameter estimates for fixed-effect treatments
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Constructed grouping variable ids
Computed size of rRsum boundary vector: 1520
Pre-computed bin ranges for bootstrap resampling
Finished initializing wspc object
Imported fe_difference_ratio: 1.496357

Estimating model parameters: 
---------------

Running bootstrap fits (forking): 
Batch 0/10, 0.364697 sec/bs
Batch 1/10, 0.530389 sec/bs
Batch 2/10, 0.319437 sec/bs
Batch 3/10, 0.662148 sec/bs
Batch 4/10, 0.612642 sec/bs
Batch 5/10, 0.490735 sec/bs
Batch 6/10, 0.347917 sec/bs
Batch 7/10, 0.538197 sec/bs
Batch 8/10, 0.539055 sec/bs
Batch 9/10, 0.536059 sec/bs
All complete!

Setting full-data fit as parameters... 
Checking feasibility of provided parameters
Provided parameters are feasible

Running stats on bootstrap results: 
----------------------------------------

Grabbing bootstrap results, all resamples... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from bootstraped parameters... 

Stat summary (head only):
------------------------------
                              parameter    estimate      CI.low      CI.high    p.value p.value.adj    alpha.adj significance
1       baseline_cortex_Rt_Arc_Tns/Blk1 10.97738879 10.92972221 11.002113082 0.00000000    0.000000 7.974482e-05          ***
2   beta_Rt_cortex_Arc_right_X_Tns/Blk1 -0.02714826 -0.06864769 -0.022317350 0.00990099    2.089109 2.369668e-04           ns
3      beta_Rt_cortex_Arc_18_X_Tns/Blk1  0.08449702  0.06425064  0.097291671 0.00000000    0.000000 7.987220e-05          ***
4 beta_Rt_cortex_Arc_right18_X_Tns/Blk1  0.03203169  0.01192858  0.039909071 0.00000000    0.000000 8.000000e-05          ***
5       baseline_cortex_Rt_Arc_Tns/Blk2 10.59403930 10.55760317 10.623200939 0.00000000    0.000000 8.012821e-05          ***
6   beta_Rt_cortex_Arc_right_X_Tns/Blk2 -0.03789001 -0.05208261 -0.008493332 0.00000000    0.000000 8.025682e-05          ***
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group         mean        sd  variance
1          all  0.004060028 0.4316843 0.1863514
2 ran_lvl_none -0.045486164 0.3578089 0.1280272
3    ran_lvl_1 -0.006082415 0.4658504 0.2170166
4    ran_lvl_2  0.025594887 0.4081147 0.1665576
5    ran_lvl_3  0.057328523 0.5088401 0.2589182
6    ran_lvl_4  0.038491500 0.4587192 0.2104233
----

TPS test results (head only):
------------------------------
              cortex   gene TPS.ref TPS.right TPS.18 TPS.right18 Rt.18 tpoint.18 tslope.18 Rt.right tpoint.right tslope.right Rt.right18 tpoint.right18 tslope.right18
Arc.cortex    cortex    Arc   FALSE     FALSE  FALSE       FALSE  TRUE      TRUE      TRUE     TRUE         TRUE         TRUE       TRUE           TRUE           TRUE
Bcl11b.cortex cortex Bcl11b    TRUE      TRUE  FALSE       FALSE  TRUE      TRUE      TRUE    FALSE         TRUE         TRUE       TRUE           TRUE           TRUE
Camk2a.cortex cortex Camk2a    TRUE      TRUE   TRUE        TRUE  TRUE      TRUE      TRUE     TRUE         TRUE         TRUE       TRUE           TRUE           TRUE
Dlx2.cortex   cortex   Dlx2    TRUE      TRUE   TRUE        TRUE FALSE      TRUE      TRUE    FALSE         TRUE         TRUE      FALSE           TRUE           TRUE
Fezf2.cortex  cortex  Fezf2    TRUE      TRUE   TRUE        TRUE  TRUE      TRUE      TRUE     TRUE         TRUE         TRUE       TRUE           TRUE           TRUE
Grin2a.cortex cortex Grin2a    TRUE      TRUE   TRUE        TRUE  TRUE      TRUE      TRUE     TRUE         TRUE         TRUE      FALSE           TRUE           TRUE
----

Printing structural summary distributions: 
----------------------------------------

Warping factors, beta distributions... 
Rate effects, Gaussian distribution... 
Slope effects, Gaussian distribution... 
tpoint effects, Gaussian distribution... 
Making rate-count plots... 

Printing child summary plots: 
----------------------------------------

Making summary plots for cortex: Arc, Bcl11b, Camk2a, Dlx2, Fezf2, Grin2a, Ncdn, Nptxr, Nr4a2, Rorb, Satb2