

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 4 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P12_z0-3_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 4: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.722, 1.902, 0.897, 1.216
Mean of means: 1.434
Standard deviation of means: 0.461

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA     CNU-HYa GABA     CNU-MGE GABA CTX-CGE/MGE GABA         filtered 
            1255               24               12                7              652             6917 
         HY GABA           Immune       IT-ET Glut         LSX GABA          MB GABA       MH-LH Glut 
              14              122             7388               12               18                9 
         MY GABA   NP-CT-L6b Glut      OB-IMN GABA              OEC        OPC-Oligo           P GABA 
             203             1365               51               16              242               68 
 TSCRPT_filtered         Vascular          CB Glut     CNU-LGE GABA      DG-IMN Glut          MY Glut 
               6             2015               19                4                7                2 
      OB-CR Glut          TH Glut     CNU-HYa Glut    HY Gnrh1 Glut          MB Dopa           P Glut 
               0                1                1                2                2                2 
     Pineal Glut       MB-HB Sero 
               5                1 
----

Number of mice: 4
Cells per mouse: 4734, 5759, 4514, 5435
Means cells per mouse: 5110.5
Total cells: 20442

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, correcting perspective to ensure right hemisphere is on the right... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis and L1 (or L23, if L1 removed) is on top... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries...   [,1] [,2] [,3] [,4] [,5] [,6]
1   NA   67   54   23    1    0
2   NA   64   50   19    1    0
3   NA   75   62   21    1    0
4   NA   75   62   23    1    0
[1]    NA 70.25 57.00 21.50  1.00  0.00
