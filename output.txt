

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 4 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P12_z0-3_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 4: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.722, 1.902, 0.897, 1.216
Mean of means: 1.434
Standard deviation of means: 0.461

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA     CNU-HYa GABA     CNU-MGE GABA CTX-CGE/MGE GABA         filtered          HY GABA           Immune 
            1255               24               12                7              652             6917               14              122 
      IT-ET Glut         LSX GABA          MB GABA       MH-LH Glut          MY GABA   NP-CT-L6b Glut      OB-IMN GABA              OEC 
            7388               12               18                9              203             1365               51               16 
       OPC-Oligo           P GABA  TSCRPT_filtered         Vascular          CB Glut     CNU-LGE GABA      DG-IMN Glut          MY Glut 
             242               68                6             2015               19                4                7                2 
      OB-CR Glut          TH Glut     CNU-HYa Glut    HY Gnrh1 Glut          MB Dopa           P Glut      Pineal Glut       MB-HB Sero 
               0                1                1                2                2                2                5                1 
----

Number of mice: 4
Cells per mouse: 4734, 5759, 4514, 5435
Means cells per mouse: 5110.5
Total cells: 20442

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  450.1368 right mean y:  496.2797
 L4 left mean y:  232.259 right mean y:  258.1052
 L5 left mean y:  -2.377644e-13 right mean y:  9.874911e-13
 L6a left mean y:  -312.9476 right mean y:  -304.0132
 L6b left mean y:  -452.3108 right mean y:  -443.6699
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  386.4889 right mean y:  355.1827
 L4 left mean y:  210.8276 right mean y:  199.7473
 L5 left mean y:  4.560693e-13 right mean y:  -1.497351e-14
 L6a left mean y:  -300.5421 right mean y:  -263.437
 L6b left mean y:  -408.0244 right mean y:  -361.021
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  420.0385 right mean y:  412.8427
 L4 left mean y:  263.0396 right mean y:  271.1732
 L5 left mean y:  4.650211e-14 right mean y:  -1.767677e-13
 L6a left mean y:  -303.7691 right mean y:  -318.6461
 L6b left mean y:  -418.6333 right mean y:  -430.4656
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  385.0695 right mean y:  406.356
 L4 left mean y:  236.3379 right mean y:  252.4454
 L5 left mean y:  4.805023e-15 right mean y:  -5.181175e-13
 L6a left mean y:  -273.648 right mean y:  -284.5495
 L6b left mean y:  -380.2057 right mean y:  -403.3184
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... $slice_plot

$plot_untransformed

$plot_recenter

$plot_level_L4

$plot_linear_skew

$plot_level_all

$plot_nonlinear_smoothing

$hist_resids_plot

MERFISH data... 
Setting flag to remove Layer 1 from the analysis... 

Loading raw data: 
----------------------------------------

Found 4 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P12_z0-3_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 4: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data//ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.722, 1.902, 0.897, 1.216
Mean of means: 1.434
Standard deviation of means: 0.461

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA     CNU-HYa GABA     CNU-MGE GABA CTX-CGE/MGE GABA         filtered          HY GABA           Immune 
            1255               24               12                7              652             6917               14              122 
      IT-ET Glut         LSX GABA          MB GABA       MH-LH Glut          MY GABA   NP-CT-L6b Glut      OB-IMN GABA              OEC 
            7388               12               18                9              203             1365               51               16 
       OPC-Oligo           P GABA  TSCRPT_filtered         Vascular          CB Glut     CNU-LGE GABA      DG-IMN Glut          MY Glut 
             242               68                6             2015               19                4                7                2 
      OB-CR Glut          TH Glut     CNU-HYa Glut    HY Gnrh1 Glut          MB Dopa           P Glut      Pineal Glut       MB-HB Sero 
               0                1                1                2                2                2                5                1 
----

Number of mice: 4
Cells per mouse: 4734, 5759, 4514, 5435
Means cells per mouse: 5110.5
Total cells: 20442

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  450.1368 right mean y:  496.2797
 L4 left mean y:  232.259 right mean y:  258.1052
 L5 left mean y:  -2.377644e-13 right mean y:  9.874911e-13
 L6a left mean y:  -312.9476 right mean y:  -304.0132
 L6b left mean y:  -452.3108 right mean y:  -443.6699
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  386.4889 right mean y:  355.1827
 L4 left mean y:  210.8276 right mean y:  199.7473
 L5 left mean y:  4.560693e-13 right mean y:  -1.497351e-14
 L6a left mean y:  -300.5421 right mean y:  -263.437
 L6b left mean y:  -408.0244 right mean y:  -361.021
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  420.0385 right mean y:  412.8427
 L4 left mean y:  263.0396 right mean y:  271.1732
 L5 left mean y:  4.650211e-14 right mean y:  -1.767677e-13
 L6a left mean y:  -303.7691 right mean y:  -318.6461
 L6b left mean y:  -418.6333 right mean y:  -430.4656
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  385.0695 right mean y:  406.356
 L4 left mean y:  236.3379 right mean y:  252.4454
 L5 left mean y:  4.805023e-15 right mean y:  -5.181175e-13
 L6a left mean y:  -273.648 right mean y:  -284.5495
 L6b left mean y:  -380.2057 right mean y:  -403.3184
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... $slice_plot

$plot_untransformed

$plot_recenter

$plot_level_L4

$plot_linear_skew

$plot_level_all

$plot_nonlinear_smoothing

$hist_resids_plot

se number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.722, 1.902, 0.897, 1.216
Mean of means: 1.434
Standard deviation of means: 0.461

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA     CNU-HYa GABA     CNU-MGE GABA CTX-CGE/MGE GABA         filtered          HY GABA           Immune 
            1255               24               12                7              652             6917               14              122 
      IT-ET Glut         LSX GABA          MB GABA       MH-LH Glut          MY GABA   NP-CT-L6b Glut      OB-IMN GABA              OEC 
            7388               12               18                9              203             1365               51               16 
       OPC-Oligo           P GABA  TSCRPT_filtered         Vascular          CB Glut     CNU-LGE GABA      DG-IMN Glut          MY Glut 
             242               68                6             2015               19                4                7                2 
      OB-CR Glut          TH Glut     CNU-HYa Glut    HY Gnrh1 Glut          MB Dopa           P Glut      Pineal Glut       MB-HB Sero 
               0                1                1                2                2                2                5                1 
----

Number of mice: 4
Cells per mouse: 4734, 5759, 4514, 5435
Means cells per mouse: 5110.5
Total cells: 20442

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  450.1368 right mean y:  496.2797
 L4 left mean y:  232.259 right mean y:  258.1052
 L5 left mean y:  -2.377644e-13 right mean y:  9.874911e-13
 L6a left mean y:  -312.9476 right mean y:  -304.0132
 L6b left mean y:  -452.3108 right mean y:  -443.6699
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  386.4889 right mean y:  355.1827
 L4 left mean y:  210.8276 right mean y:  199.7473
 L5 left mean y:  4.560693e-13 right mean y:  -1.497351e-14
 L6a left mean y:  -300.5421 right mean y:  -263.437
 L6b left mean y:  -408.0244 right mean y:  -361.021
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  420.0385 right mean y:  412.8427
 L4 left mean y:  263.0396 right mean y:  271.1732
 L5 left mean y:  4.650211e-14 right mean y:  -1.767677e-13
 L6a left mean y:  -303.7691 right mean y:  -318.6461
 L6b left mean y:  -418.6333 right mean y:  -430.4656
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 2, centering each patch around the mean point of L5... 
Step 3, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 4, linearly transforming each patch to vertically straighten them while preserving area... 
Step 5, leveling all layers... 
 L23 left mean y:  385.0695 right mean y:  406.356
 L4 left mean y:  236.3379 right mean y:  252.4454
 L5 left mean y:  4.805023e-15 right mean y:  -5.181175e-13
 L6a left mean y:  -273.648 right mean y:  -284.5495
 L6b left mean y:  -380.2057 right mean y:  -403.3184
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... $slice_plot

$plot_untransformed

$plot_recenter

$plot_level_L4

$plot_linear_skew

$plot_level_all

$plot_nonlinear_smoothing

$hist_resids_plot

