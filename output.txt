

Analysis of MERFISH data by Warped Sigmoid, Poisson-Process Mixed-Effects Model (WSPmm)
: 

Loading helper function definitions for preprocessing MERFISH data... 

Loading raw data: 
----------------------------------------

Found 4 HDF5 files.... 
File names:
	mouse 1: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data_SSp//Somatosensory_ACxDev1_CBA-CAJ_FFPE_P12_z0-3_celltyped_filtered_withCCF.hdf5
	mouse 2: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data_SSp//Somatosensory_ACxDev1_CBA-CAJ_FFPE_P18_celltyped_filtered_withCCF.hdf5
	mouse 3: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data_SSp//Somatosensory_ACxDev1_CBA-CAJ_P12_celltyped_filtered_withCCF.hdf5
	mouse 4: /Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/MERFISH/data_SSp//Somatosensory_ACxDev1_CBA-CAJ_P18_celltyped_filtered_withCCF.hdf5
Loading and parsing file for mouse number: 1, 2, 3, 4 

Mean transcript counts per cell for each mouse: 1.677, 1.884, 1.029, 1.212
Mean of means: 1.45
Standard deviation of means: 0.397

Total cells by type (Map My Cells):
------------------------------

      Astro-Epen          CB GABA          CB Glut     CNU-HYa GABA     CNU-HYa Glut     CNU-LGE GABA     CNU-MGE GABA CTX-CGE/MGE GABA 
            3952               82               19               12                2              671               20             1351 
     DG-IMN Glut         filtered          HY GABA           Immune       IT-ET Glut         LSX GABA          MB GABA          MB Glut 
              11            18208               37              331            16066               29               79                5 
      MB-HB Sero       MH-LH Glut          MY GABA          MY Glut   NP-CT-L6b Glut      OB-IMN GABA              OEC        OPC-Oligo 
               1               15              430               21             4922              149               23             1499 
          P GABA  TSCRPT_filtered         Vascular          HY Glut    HY Gnrh1 Glut           P Glut      Pineal Glut          TH Glut 
             142               99             5914                1                1                2                5               12 
         MB Dopa       OB-CR Glut 
               2                3 
----

Number of mice: 4
Cells per mouse: 13237, 16954, 10444, 13481
Means cells per mouse: 13529
Total cells: 54116

Transforming raw data into laminar and columnar coordinates: 
----------------------------------------

Mouse number 1: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, centering each patch around the mean point of L5... 
Step 2, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 3, modeling and flattening laminar curve based on L4... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 2: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, centering each patch around the mean point of L5... 
Step 2, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 3, modeling and flattening laminar curve based on L4... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 3: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, centering each patch around the mean point of L5... 
Step 2, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 3, modeling and flattening laminar curve based on L4... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Mouse number 4: 
Performing coordinate transform... 
Grabbing coordinates and defining layers and hemispheres... 
Step 1, centering each patch around the mean point of L5... 
Step 2, rotating each patch so that L4 aligns with the x-axis with anterior in positive y direction... 
Step 3, modeling and flattening laminar curve based on L4... 
Binning transformed coordinates... 
Smoothing bin edges with nonlinear transformation... 
Estimating layer boundaries... 

Initializing Cpp (wspc) model: 
----------------------------------------

warp_precision: 1e-07
eps_: 2.22045e-16
inf_warp: 4.5036e+08
Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Bcl11b" "Cux2" "Fezf2" "Nxph3" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 12000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 120
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 480/2400
row: 960/2400
row: 1440/2400
row: 1920/2400
row: 2400/2400
Extrapolated 'none' rows
Took log of observed counts
Estimated change points with LROcp and found initial parameter estimates for fixed-effect treatments
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Number of parameters: 216
Constructed grouping variable IDs
Computed size of boundary vector: 840
Finished initializing wspc object

Estimating model parameters: 
---------------
Forking available and bootstrap requested.... 
If bootstrapping not desired, set bootstraps.num = 0... 

Running MCMC stimulations (single-threaded): 
Checking feasibility of provided parameters
Found tpoint below buffer, dist: -2.000000, deg: 3, row: 1700
... tpoints found below buffer
Provided parameters not feasible, searching nearby
Initial boundary distance (want to make >0): -2
Numer of evals: 2
Success code: 2
Final boundary distance: 0.247647
Nearby feasible parameters found!
Performing initial fit of full data
Penalized neg_loglik: 12075.4
step: 1/1000
step: 100/1000
step: 200/1000
step: 300/1000
step: 400/1000
step: 500/1000
step: 600/1000
step: 700/1000
step: 800/1000
step: 900/1000
All complete!
Acceptance rate (aim for 0.2-0.3): 0.230282

MCMC simulation complete... 
MCMC run time (total), minutes: 2.374
MCMC run time (per retained step), seconds: 0.142
MCMC run time (per step), seconds: 0.071

Running bootstrap fits (with forking): 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible
Performing initial fit of full data
Penalized neg_loglik: 12075.4
Batch: 1/100, 0.323631 sec/bs
Batch: 10/100, 0.330111 sec/bs
Batch: 20/100, 0.349839 sec/bs
Batch: 30/100, 0.320403 sec/bs
Batch: 40/100, 0.32789 sec/bs
Batch: 50/100, 0.333452 sec/bs
Batch: 60/100, 0.32916 sec/bs
Batch: 70/100, 0.323747 sec/bs
Batch: 80/100, 0.355052 sec/bs
Batch: 90/100, 0.352519 sec/bs
All complete!

Bootstrap simulation complete... 
Bootstrap run time (total), minutes: 5.663
Bootstrap run time (per sample), seconds: 0.34
Bootstrap run time (per sample, per thread), seconds: 3.398

Setting full-data fit as parameters... 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible

Running stats on simulation results: 
----------------------------------------

Grabbing sample results, only resamples with converged fit... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from resampled parameters... 

Recommended resample size for alpha = 0.05, 108 tests: 
with bootstrapping/MCMC: 2160
Actual resample size: 1001

Stat summary (head only):
------------------------------
                                 parameter     estimate      CI.low    CI.high    p.value p.value.adj   alpha.adj significance
1       baseline_cortex_Rt_Bcl11b_Tns/Blk1  3.395479787  3.32084853 3.41740452         NA          NA          NA             
2   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk1 -0.001137413 -0.06696198 0.06485079 0.96603397   0.9660340 0.050000000           ns
3      beta_Rt_cortex_Bcl11b_18_X_Tns/Blk1  0.606553807  0.52481566 0.72555156 0.00000000   0.0000000 0.000462963          ***
4 beta_Rt_cortex_Bcl11b_right18_X_Tns/Blk1  0.034108725 -0.08398568 0.15175582 0.41658342   7.0819181 0.002941176           ns
5       baseline_cortex_Rt_Bcl11b_Tns/Blk2  2.102752575  1.88962024 2.10229526         NA          NA          NA             
6   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk2  0.165340833 -0.02079351 0.41437189 0.01898102   0.7402597 0.001282051           ns
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group      mean        sd  variance
1          all 0.2255392 0.4111012 0.1690042
2 ran_lvl_none 0.2249288 0.3400286 0.1156195
3    ran_lvl_1 0.2201289 0.4201653 0.1765389
4    ran_lvl_2 0.2120459 0.4221445 0.1782060
5    ran_lvl_3 0.2459318 0.4773733 0.2278853
6    ran_lvl_4 0.2252709 0.4473657 0.2001361
----


Printing effect distributions: 
----------------------------------------

Warping factors distributions... 
Rate effects distribution... 
Slope effects distribution... 
tpoint effects distribution... 
Making rate-count plots... 

Printing child summary plots: 
----------------------------------------

Making summary plots for cortex: Bcl11b, Cux2, Fezf2, Nxph3, Rorb, Satb2

Initializing Cpp (wspc) model: 
----------------------------------------

warp_precision: 1e-07
eps_: 2.22045e-16
inf_warp: 4.5036e+08
Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Bcl11b" "Cux2" "Fezf2" "Nxph3" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 12000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 120
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 480/2400
row: 960/2400
row: 1440/2400
row: 1920/2400
row: 2400/2400
Extrapolated 'none' rows
Took log of observed counts
Estimated change points with LROcp and found initial parameter estimates for fixed-effect treatments
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Number of parameters: 384
Constructed grouping variable IDs
Computed size of boundary vector: 1680
Finished initializing wspc object

Estimating model parameters: 
---------------
Forking available and bootstrap requested.... 
If bootstrapping not desired, set bootstraps.num = 0... 

Running MCMC stimulations (single-threaded): 
Checking feasibility of provided parameters
Found tpoint below buffer, dist: -1.166667, deg: 4, row: 0
... tpoints found below buffer
Provided parameters not feasible, searching nearby
Initial boundary distance (want to make >0): -1.50338
Numer of evals: 14
Success code: 2
Final boundary distance: 0.247647
Nearby feasible parameters found!
Performing initial fit of full data
Penalized neg_loglik: 12036.3
step: 1/1000
step: 100/1000
step: 200/1000
step: 300/1000
step: 400/1000
step: 500/1000
step: 600/1000
step: 700/1000
step: 800/1000
step: 900/1000
All complete!
Acceptance rate (aim for 0.2-0.3): 0.138581

MCMC simulation complete... 
MCMC run time (total), minutes: 4.36
MCMC run time (per retained step), seconds: 0.262
MCMC run time (per step), seconds: 0.131

Running bootstrap fits (with forking): 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible
Performing initial fit of full data
Penalized neg_loglik: 12036.3
Batch: 1/100, 0.580287 sec/bs
Batch: 10/100, 0.608936 sec/bs
Batch: 20/100, 0.53931 sec/bs
Batch: 30/100, 0.575225 sec/bs
Batch: 40/100, 0.613233 sec/bs
Batch: 50/100, 0.56444 sec/bs
Batch: 60/100, 0.551786 sec/bs
Batch: 70/100, 0.588537 sec/bs
Batch: 80/100, 0.555254 sec/bs
Batch: 90/100, 0.606366 sec/bs
All complete!

Bootstrap simulation complete... 
Bootstrap run time (total), minutes: 9.717
Bootstrap run time (per sample), seconds: 0.583
Bootstrap run time (per sample, per thread), seconds: 5.83

Setting full-data fit as parameters... 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible

Running stats on simulation results: 
----------------------------------------

Grabbing sample results, only resamples with converged fit... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from resampled parameters... 

Recommended resample size for alpha = 0.05, 234 tests: 
with bootstrapping/MCMC: 4680
Actual resample size: 1001

Stat summary (head only):
------------------------------
                                 parameter     estimate     CI.low    CI.high   p.value p.value.adj    alpha.adj significance
1       baseline_cortex_Rt_Bcl11b_Tns/Blk1  3.419271811  3.3182436 3.43044239        NA          NA           NA             
2   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk1 -0.004179011 -0.1174745 0.08121675 0.8991009    6.293706 0.0071428571           ns
3      beta_Rt_cortex_Bcl11b_18_X_Tns/Blk1  0.560525572  0.4700181 0.70871805 0.0000000    0.000000 0.0002136752          ***
4 beta_Rt_cortex_Bcl11b_right18_X_Tns/Blk1  0.061234058 -0.0819731 0.24519792 0.2337662   14.025974 0.0008333333           ns
5       baseline_cortex_Rt_Bcl11b_Tns/Blk2  3.047407361  2.0324120 3.53128197        NA          NA           NA             
6   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk2  0.114681146 -0.7294013 1.25296402 0.5204795   16.655345 0.0015625000           ns
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group      mean        sd   variance
1          all 0.2253027 0.3740794 0.13993537
2 ran_lvl_none 0.2259179 0.2999216 0.08995295
3    ran_lvl_1 0.2200211 0.3830229 0.14670652
4    ran_lvl_2 0.2104247 0.3822888 0.14614476
5    ran_lvl_3 0.2452445 0.4369978 0.19096706
6    ran_lvl_4 0.2242902 0.4192222 0.17574725
----


Printing effect distributions: 
----------------------------------------

Warping factors distributions... 
Rate effects distribution... 
Slope effects distribution... 
tpoint effects distribution... 
Making rate-count plots... 

Printing child summary plots: 
----------------------------------------

Making summary plots for cortex: Bcl11b, Cux2, Fezf2, Nxph3, Rorb, Satb2

Initializing Cpp (wspc) model: 
----------------------------------------

warp_precision: 1e-07
eps_: 2.22045e-16
inf_warp: 4.5036e+08
Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Bcl11b" "Cux2" "Fezf2" "Nxph3" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 12000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 120
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 480/2400
row: 960/2400
row: 1440/2400
row: 1920/2400
row: 2400/2400
Extrapolated 'none' rows
Took log of observed counts
Estimated change points with LROcp and found initial parameter estimates for fixed-effect treatments
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Number of parameters: 240
Constructed grouping variable IDs
Computed size of boundary vector: 960
Finished initializing wspc object

Estimating model parameters: 
---------------
Forking available and bootstrap requested.... 
If bootstrapping not desired, set bootstraps.num = 0... 

Running MCMC stimulations (single-threaded): 
Checking feasibility of provided parameters
Found tpoint below buffer, dist: -1.666667, deg: 3, row: 800
... tpoints found below buffer
Provided parameters not feasible, searching nearby
Initial boundary distance (want to make >0): -3.33333
Numer of evals: 6
Success code: 2
Final boundary distance: 0.247647
Nearby feasible parameters found!
Performing initial fit of full data
Penalized neg_loglik: 12073.2
step: 1/100
step: 10/100
step: 20/100
step: 30/100
step: 40/100
step: 50/100
step: 60/100
step: 70/100
step: 80/100
step: 90/100
All complete!
Acceptance rate (aim for 0.2-0.3): 0.297177

MCMC simulation complete... 
MCMC run time (total), minutes: 0.24
MCMC run time (per retained step), seconds: 0.144
MCMC run time (per step), seconds: 0.072

Running bootstrap fits (with forking): 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible
Performing initial fit of full data
Penalized neg_loglik: 12073.2
Batch: 1/10, 0.503171 sec/bs
Batch: 2/10, 0.520198 sec/bs
Batch: 3/10, 0.47966 sec/bs
Batch: 4/10, 0.515888 sec/bs
Batch: 5/10, 0.466344 sec/bs
Batch: 6/10, 0.492151 sec/bs
Batch: 7/10, 0.521648 sec/bs
Batch: 8/10, 0.508881 sec/bs
Batch: 9/10, 0.509715 sec/bs
All complete!

Bootstrap simulation complete... 
Bootstrap run time (total), minutes: 0.909
Bootstrap run time (per sample), seconds: 0.546
Bootstrap run time (per sample, per thread), seconds: 5.456

Setting full-data fit as parameters... 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible

Running stats on simulation results: 
----------------------------------------

Grabbing sample results, only resamples with converged fit... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from resampled parameters... 

Recommended resample size for alpha = 0.05, 126 tests: 
with bootstrapping/MCMC: 2520
Actual resample size: 101

Stat summary (head only):
------------------------------
                                 parameter     estimate       CI.low    CI.high    p.value p.value.adj    alpha.adj significance
1       baseline_cortex_Rt_Bcl11b_Tns/Blk1  3.398995211  3.331569578 3.42897163         NA          NA           NA             
2   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk1 -0.001618335 -0.082744266 0.05311579 0.94059406   2.8217822 0.0166666667           ns
3      beta_Rt_cortex_Bcl11b_18_X_Tns/Blk1  0.611250748  0.524734101 0.69595638 0.00000000   0.0000000 0.0003968254          ***
4 beta_Rt_cortex_Bcl11b_right18_X_Tns/Blk1  0.030279568 -0.043993437 0.15845886 0.49504950  10.8910891 0.0022727273           ns
5       baseline_cortex_Rt_Bcl11b_Tns/Blk2  2.103797244  1.877077297 2.09657342         NA          NA           NA             
6   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk2  0.164599057 -0.008339627 0.33562286 0.00990099   0.6435644 0.0007692308           ns
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group      mean        sd  variance
1          all 0.2251306 0.4092906 0.1675188
2 ran_lvl_none 0.2248799 0.3372131 0.1137127
3    ran_lvl_1 0.2200680 0.4140073 0.1714021
4    ran_lvl_2 0.2117061 0.4150389 0.1722573
5    ran_lvl_3 0.2448194 0.4776195 0.2281204
6    ran_lvl_4 0.2244302 0.4537804 0.2059167
----


Printing effect distributions: 
----------------------------------------

Warping factors distributions... 
Rate effects distribution... 
Slope effects distribution... 
tpoint effects distribution... 
Making rate-count plots... 

Printing child summary plots: 
----------------------------------------

Making summary plots for cortex: Bcl11b, Cux2, Fezf2, Nxph3, Rorb, Satb2

Initializing Cpp (wspc) model: 
----------------------------------------

warp_precision: 1e-07
eps_: 2.22045e-16
inf_warp: 4.5036e+08
Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Bcl11b" "Cux2" "Fezf2" "Nxph3" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 12000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 120
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 480/2400
row: 960/2400
row: 1440/2400
row: 1920/2400
row: 2400/2400
Extrapolated 'none' rows
Took log of observed counts
Estimated change points with LROcp and found initial parameter estimates for fixed-effect treatments
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Number of parameters: 384
Constructed grouping variable IDs
Computed size of boundary vector: 1680
Finished initializing wspc object

Estimating model parameters: 
---------------
Forking available and bootstrap requested.... 
If bootstrapping not desired, set bootstraps.num = 0... 

Running MCMC stimulations (single-threaded): 
Checking feasibility of provided parameters
Found tpoint below buffer, dist: -3.666667, deg: 4, row: 0
... tpoints found below buffer
Provided parameters not feasible, searching nearby
Initial boundary distance (want to make >0): -4.00338
Numer of evals: 158
Success code: 3
Final boundary distance: -0.0658783
Could not find a nearby feasible parameters, returning provided ones

Enter a frame number, or 0 to exit   

1: wisp(count.data.raw = count.data.WSPmm, variables = data.variables, use.median = FALSE, MCMC.burnin = 0, MCMC.steps = 100, MCMC.step.siz
2: cpp_model$MCMC(MCMC.steps + MCMC.burnin, MCMC.neighbor.filter, MCMC.step.size, MCMC.prior, verbose)



Initializing Cpp (wspc) model: 
----------------------------------------

warp_precision: 1e-07
eps_: 2.22045e-16
inf_warp: 4.5036e+08
Data structure check passed
Saving tokenized count
Found max bin: 100.000000
Extracted fixed effects:
"hemisphere" "age"
Ref levels:
"left" "12"
Created treatment levels
"ref" "right" "18" "right18"
Created treatment-to-fix translation matrix
Pre-computed weight matrix rows
Extracted parent grouping variables:
"cortex"
Extracted child grouping variables:
"Bcl11b" "Cux2" "Fezf2" "Nxph3" "Rorb" "Satb2"
Extracted random-effect grouping variables:
"none" "1" "2" "3" "4"
Extracted tokenized count columns
Grabbed size constants for summed count data, total rows: 12000
Initialized columns for summed count data
Initialized count indexes, number of rows with unique model components: 120
Pre-computing bin masks
Creating summed-count data columns ...
Random level 0, 1/5 complete
Random level 1, 2/5 complete
Random level 2, 3/5 complete
Random level 3, 4/5 complete
Random level 4, 5/5 complete
Extracted non-NA indexes
Making extrapolation pool ...
row: 480/2400
row: 960/2400
row: 1440/2400
row: 1920/2400
row: 2400/2400
Extrapolated 'none' rows
Took log of observed counts
Estimated change points with LROcp and found initial parameter estimates for fixed-effect treatments
Built initial beta (ref and fixed-effects) matrices
Initialized random effect warping factors
Made and mapped parameter vector
Number of parameters: 300
Constructed grouping variable IDs
Computed size of boundary vector: 1260
Finished initializing wspc object

Estimating model parameters: 
---------------
Forking available and bootstrap requested.... 
If bootstrapping not desired, set bootstraps.num = 0... 

Running MCMC stimulations (single-threaded): 
Checking feasibility of provided parameters
Found tpoint below buffer, dist: -1.000000, deg: 3, row: 100
... tpoints found below buffer
Provided parameters not feasible, searching nearby
Initial boundary distance (want to make >0): -3.001
Numer of evals: 3
Success code: 2
Final boundary distance: 0.247647
Nearby feasible parameters found!
Performing initial fit of full data
Penalized neg_loglik: 12046.2
step: 1/100
step: 10/100
step: 20/100
step: 30/100
step: 40/100
step: 50/100
step: 60/100
step: 70/100
step: 80/100
step: 90/100
All complete!
Acceptance rate (aim for 0.2-0.3): 0.207469

MCMC simulation complete... 
MCMC run time (total), minutes: 0.329
MCMC run time (per retained step), seconds: 0.197
MCMC run time (per step), seconds: 0.099

Running bootstrap fits (with forking): 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible
Performing initial fit of full data
Penalized neg_loglik: 12046.2
Batch: 1/10, 0.472543 sec/bs
Batch: 2/10, 0.455204 sec/bs
Batch: 3/10, 0.494218 sec/bs
Batch: 4/10, 0.473163 sec/bs
Batch: 5/10, 0.489006 sec/bs
Batch: 6/10, 0.478388 sec/bs
Batch: 7/10, 0.505708 sec/bs
Batch: 8/10, 0.535728 sec/bs
Batch: 9/10, 0.497627 sec/bs
All complete!

Bootstrap simulation complete... 
Bootstrap run time (total), minutes: 0.876
Bootstrap run time (per sample), seconds: 0.526
Bootstrap run time (per sample, per thread), seconds: 5.257

Setting full-data fit as parameters... 
Checking feasibility of provided parameters
... no tpoints below buffer
... no negative rates predicted
Provided parameters are feasible

Running stats on simulation results: 
----------------------------------------

Grabbing sample results, only resamples with converged fit... 
Grabbing parameter values... 
Computing 95% confidence intervals... 
Estimating p-values from resampled parameters... 

Recommended resample size for alpha = 0.05, 171 tests: 
with bootstrapping/MCMC: 3420
Actual resample size: 101

Stat summary (head only):
------------------------------
                                 parameter     estimate      CI.low   CI.high   p.value p.value.adj    alpha.adj significance
1       baseline_cortex_Rt_Bcl11b_Tns/Blk1  3.395107965  3.33111271 3.4175477        NA          NA           NA             
2   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk1  0.002982114 -0.07444717 0.0785867 0.9207921    5.524752 0.0083333333           ns
3      beta_Rt_cortex_Bcl11b_18_X_Tns/Blk1  0.593448754  0.50800834 0.6841922 0.0000000    0.000000 0.0002923977          ***
4 beta_Rt_cortex_Bcl11b_right18_X_Tns/Blk1  0.041416239 -0.08675040 0.1521240 0.4158416   14.138614 0.0014705882           ns
5       baseline_cortex_Rt_Bcl11b_Tns/Blk2  2.319604756  1.89872639 2.5239396        NA          NA           NA             
6   beta_Rt_cortex_Bcl11b_right_X_Tns/Blk2 -0.036314639 -0.69184497 0.5381995 0.8910891    8.019802 0.0055555556           ns
----

Analyzing residuals: 
----------------------------------------

Computing residuals... 
Making masks... 
Making plots and saving stats... 

Log-residual summary by grouping variables (head only):
------------------------------
         group      mean        sd   variance
1          all 0.2252133 0.3833440 0.14695264
2 ran_lvl_none 0.2244876 0.3081029 0.09492742
3    ran_lvl_1 0.2201257 0.3885565 0.15097618
4    ran_lvl_2 0.2112826 0.3954888 0.15641141
5    ran_lvl_3 0.2459086 0.4480074 0.20071067
6    ran_lvl_4 0.2249876 0.4285400 0.18364650
----


Printing effect distributions: 
----------------------------------------

Warping factors distributions... 
Rate effects distribution... 
Slope effects distribution... 
tpoint effects distribution... 
Making rate-count plots... 

Printing child summary plots: 
----------------------------------------

Making summary plots for cortex: Bcl11b, Cux2, Fezf2, Nxph3, Rorb, Satb2RStudioGD 
        2 
RStudioGD 
        2 
RStudioGD 
        2 
